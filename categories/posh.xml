<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Joon's Blog (Posts about posh)</title><link>http://joonro.github.io/blog/</link><description></description><atom:link href="http://joonro.github.io/blog/categories/posh.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Mon, 02 Mar 2020 00:24:51 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>My PowerShell Customizations</title><link>http://joonro.github.io/blog/posts/powershell-customizations/</link><dc:creator>Joon Ro</dc:creator><description>&lt;div&gt;&lt;p&gt;I describe my customizations for PowerShell. With these, my PowerShell
terminal looks like the following screenshot. Not only these customizations
make it look great, but also they make me productive in the command line in
Windows.&lt;/p&gt;
&lt;img alt="../../images/posh_prompt.png" src="http://joonro.github.io/blog/images/posh_prompt.png"&gt;
&lt;div class="section" id="conemu"&gt;
&lt;h2&gt;ConEmu&lt;/h2&gt;
&lt;p&gt;I use ConEmu as my terminal emulator. ConEmu provides tabbed sessions,
changing color schemes on-the-fly, and many customization options.&lt;/p&gt;
&lt;div class="section" id="color-themes"&gt;
&lt;h3&gt;Color Themes&lt;/h3&gt;
&lt;p&gt;The screenshots are taken with &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;moe-dark&lt;/span&gt; theme&lt;/code&gt;. ConEmu comes with many color
schemes, and I also maintain a github repository which contains my favorite
color themes for ConEmu. You can check out the &lt;a class="reference external" href="https://github.com/joonro/ConEmu-Color-Themes"&gt;GitHub&lt;/a&gt; repository.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="posh-git-and-prompt-customization"&gt;
&lt;h2&gt;posh-git and prompt customization&lt;/h2&gt;
&lt;div class="admonition note"&gt;
&lt;p class="admonition-title"&gt;Note&lt;/p&gt;
&lt;p&gt;The current customization is for posh-git 0.7.x. posh-git 1.0.0 uses
a different way of customization.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;To get git-related information on your prompt, you should get &lt;a class="reference external" href="https://github.com/dahlbyk/posh-git"&gt;posh-git&lt;/a&gt;. Then,
you can show the git-related information along with other useful information
by modifying &lt;code class="docutils literal"&gt;prompt()&lt;/code&gt; function. For example:&lt;/p&gt;
&lt;pre class="code powershell"&gt;&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-1"&gt;&lt;/a&gt;&lt;span class="c"&gt;# http://serverfault.com/questions/95431&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="nb"&gt;Test-Administrator&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-3"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;$user&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="no"&gt;[Security.Principal.WindowsIdentity]&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;GetCurrent&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;New-Object&lt;/span&gt; &lt;span class="n"&gt;Security&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Principal&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WindowsPrincipal&lt;/span&gt; &lt;span class="nv"&gt;$user&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;IsInRole&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;[Security.Principal.WindowsBuiltinRole]&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Administrator&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-5"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;prompt&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-8"&gt;&lt;/a&gt;    &lt;span class="c"&gt;# https://github.com/dahlbyk/posh-git/wiki/Customizing-Your-PowerShell-Prompt&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-9"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;$origLastExitCode&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$LastExitCode&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-10"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-VcsStatus&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Test-Administrator&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c"&gt;# if elevated&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-13"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;"(Elevated) "&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;White&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-14"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-16"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;"$env:USERNAME@"&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;Red&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-17"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;"$env:COMPUTERNAME"&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;Yellow&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-18"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;" : "&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;DarkGray&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-19"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-20"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;$curPath&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$ExecutionContext&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SessionState&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CurrentLocation&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Path&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-21"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$curPath&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ToLower&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;StartsWith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$Home&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ToLower&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-23"&gt;&lt;/a&gt;        &lt;span class="nv"&gt;$curPath&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"~"&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="nv"&gt;$curPath&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SubString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$Home&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-24"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-25"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-26"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="nv"&gt;$curPath&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;Green&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-27"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;" : "&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;DarkGray&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-28"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Get-Date&lt;/span&gt; &lt;span class="n"&gt;-Format&lt;/span&gt; &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;Blue&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-29"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="s2"&gt;" : "&lt;/span&gt; &lt;span class="n"&gt;-NoNewline&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;DarkGray&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-30"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;$LastExitCode&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$origLastExitCode&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-31"&gt;&lt;/a&gt;    &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;`n&lt;/span&gt;&lt;span class="p"&gt;$(&lt;/span&gt;&lt;span class="s1"&gt;'&amp;gt;'&lt;/span&gt; &lt;span class="p"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$nestedPromptLevel&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="s2"&gt; "&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-32"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-33"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-34"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Import-Module&lt;/span&gt; &lt;span class="n"&gt;posh-git&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-35"&gt;&lt;/a&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-36"&gt;&lt;/a&gt;&lt;span class="nv"&gt;$global:GitPromptSettings&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BeforeText&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'['&lt;/span&gt;
&lt;a name="rest_code_e72e1cdd4ee64f1c8a916db18403fbb1-37"&gt;&lt;/a&gt;&lt;span class="nv"&gt;$global:GitPromptSettings&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AfterText&lt;/span&gt;  &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'] '&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="color-coding-get-childitem"&gt;
&lt;h2&gt;Color coding &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Get-ChildItem&lt;/span&gt;&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;To color-code the results of &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Get-ChildItem&lt;/span&gt;&lt;/code&gt;, I use my own
&lt;a class="reference external" href="https://github.com/joonro/Get-ChildItemColor"&gt;Get-ChildItemColor&lt;/a&gt;. Once you install it, you can set aliases to the exposed functions:&lt;/p&gt;
&lt;pre class="code powershell"&gt;&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;If&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-Not&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Test-Path&lt;/span&gt; &lt;span class="n"&gt;Variable&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;PSise&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c"&gt;# Only run this in the console and not in the ISE&lt;/span&gt;
&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-2"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Import-Module&lt;/span&gt; &lt;span class="nb"&gt;Get-ChildItemColor&lt;/span&gt;
&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-4"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Set-Alias&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="nb"&gt;Get-ChildItemColor&lt;/span&gt; &lt;span class="n"&gt;-option&lt;/span&gt; &lt;span class="n"&gt;AllScope&lt;/span&gt;
&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-5"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Set-Alias&lt;/span&gt; &lt;span class="nb"&gt;ls Get-ChildItemColorFormatWide&lt;/span&gt; &lt;span class="n"&gt;-option&lt;/span&gt; &lt;span class="n"&gt;AllScope&lt;/span&gt;
&lt;a name="rest_code_11ac22bcca6a4762889a5bfcf7b59ab4-6"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;so you have colored versions of &lt;code class="docutils literal"&gt;l&lt;/code&gt; and &lt;code class="docutils literal"&gt;ls&lt;/code&gt; equivalents.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="psreadline"&gt;
&lt;h2&gt;PSReadLine&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/lzybkr/PSReadLine"&gt;PSReadLine&lt;/a&gt; makes PowerShell to behave like &lt;code class="docutils literal"&gt;zsh&lt;/code&gt;, which is my favorite shell
in GNU/Linux. It gives you substring history search, incremental history
search, and awesome tab-completion. The following is my current setup:&lt;/p&gt;
&lt;pre class="code powershell"&gt;&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-1"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Import-Module&lt;/span&gt; &lt;span class="n"&gt;PSReadLine&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadLineOption&lt;/span&gt; &lt;span class="n"&gt;-HistoryNoDuplicates&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-4"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadLineOption&lt;/span&gt; &lt;span class="n"&gt;-HistorySearchCursorMovesToEnd&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-5"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadLineOption&lt;/span&gt; &lt;span class="n"&gt;-HistorySaveStyle&lt;/span&gt; &lt;span class="n"&gt;SaveIncrementally&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-6"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadLineOption&lt;/span&gt; &lt;span class="n"&gt;-MaximumHistoryCount&lt;/span&gt; &lt;span class="n"&gt;4000&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-7"&gt;&lt;/a&gt;&lt;span class="c"&gt;# history substring search&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-8"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadlineKeyHandler&lt;/span&gt; &lt;span class="n"&gt;-Key&lt;/span&gt; &lt;span class="n"&gt;UpArrow&lt;/span&gt; &lt;span class="n"&gt;-Function&lt;/span&gt; &lt;span class="n"&gt;HistorySearchBackward&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-9"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadlineKeyHandler&lt;/span&gt; &lt;span class="n"&gt;-Key&lt;/span&gt; &lt;span class="n"&gt;DownArrow&lt;/span&gt; &lt;span class="n"&gt;-Function&lt;/span&gt; &lt;span class="n"&gt;HistorySearchForward&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-11"&gt;&lt;/a&gt;&lt;span class="c"&gt;# Tab completion&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-12"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadlineKeyHandler&lt;/span&gt; &lt;span class="n"&gt;-Chord&lt;/span&gt; &lt;span class="s1"&gt;'Shift+Tab'&lt;/span&gt; &lt;span class="n"&gt;-Function&lt;/span&gt; &lt;span class="n"&gt;Complete&lt;/span&gt;
&lt;a name="rest_code_0e2cbe5e75904ecdaeb720f475132508-13"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-PSReadlineKeyHandler&lt;/span&gt; &lt;span class="n"&gt;-Key&lt;/span&gt; &lt;span class="n"&gt;Tab&lt;/span&gt; &lt;span class="n"&gt;-Function&lt;/span&gt; &lt;span class="n"&gt;MenuComplete&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;With these settings, I can press up and down arrows for history substring
search, and the tab completion shows me available candidates. For example:&lt;/p&gt;
&lt;img alt="../../images/posh_PSReadLine_tab_completion.png" src="http://joonro.github.io/blog/images/posh_PSReadLine_tab_completion.png"&gt;
&lt;p&gt;You can also use &lt;code class="docutils literal"&gt;CTRL + r&lt;/code&gt; for incremental history search.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="others"&gt;
&lt;h2&gt;Others&lt;/h2&gt;
&lt;div class="section" id="cddash"&gt;
&lt;h3&gt;&lt;code class="docutils literal"&gt;cddash&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;You can use the following to have the "dash" functionality - namely, you can go
back to the previous location by typing &lt;code class="docutils literal"&gt;cd -&lt;/code&gt;. It is from
&lt;a class="reference external" href="http://goo.gl/xRbYbk"&gt;http://goo.gl/xRbYbk&lt;/a&gt;.&lt;/p&gt;
&lt;pre class="code powershell"&gt;&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;cddash&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-eq&lt;/span&gt; &lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-3"&gt;&lt;/a&gt;        &lt;span class="nv"&gt;$pwd&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$OLDPWD&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-5"&gt;&lt;/a&gt;        &lt;span class="nv"&gt;$pwd&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-6"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-7"&gt;&lt;/a&gt;    &lt;span class="nv"&gt;$tmp&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pwd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$pwd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-10"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;Set-Location&lt;/span&gt; &lt;span class="nv"&gt;$pwd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-11"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-12"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;Set-Variable&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;OLDPWD&lt;/span&gt; &lt;span class="n"&gt;-Value&lt;/span&gt; &lt;span class="nv"&gt;$tmp&lt;/span&gt; &lt;span class="n"&gt;-Scope&lt;/span&gt; &lt;span class="n"&gt;global&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-13"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-14"&gt;&lt;/a&gt;
&lt;a name="rest_code_263faeaff61345929d2c3d701e21476e-15"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-Alias&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="nb"&gt;cd &lt;/span&gt;&lt;span class="n"&gt;-value&lt;/span&gt; &lt;span class="n"&gt;cddash&lt;/span&gt; &lt;span class="n"&gt;-Option&lt;/span&gt; &lt;span class="n"&gt;AllScope&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="boost-startup-speed"&gt;
&lt;h3&gt;Boost startup speed&lt;/h3&gt;
&lt;p&gt;If you feel it takes a lot of time to start a PowerShell session due to your
profile script, I found running the following (I saved it as &lt;code class="docutils literal"&gt;ngen.ps1&lt;/code&gt;) in an
elevated PowerShell helps a lot.&lt;/p&gt;
&lt;pre class="code powershell"&gt;&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;$env:path&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="no"&gt;[Runtime.InteropServices.RuntimeEnvironment]&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;GetRuntimeDirectory&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-2"&gt;&lt;/a&gt;&lt;span class="no"&gt;[AppDomain]&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CurrentDomain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetAssemblies&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;%&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-3"&gt;&lt;/a&gt;  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(!&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;continue&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-4"&gt;&lt;/a&gt;  &lt;span class="nv"&gt;$Name&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Split-Path&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="n"&gt;-leaf&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-5"&gt;&lt;/a&gt;  &lt;span class="nb"&gt;Write-Host&lt;/span&gt; &lt;span class="n"&gt;-ForegroundColor&lt;/span&gt; &lt;span class="n"&gt;Yellow&lt;/span&gt; &lt;span class="s2"&gt;"NGENing : $Name"&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-6"&gt;&lt;/a&gt;  &lt;span class="n"&gt;ngen&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="nv"&gt;$_&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;%&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;`t&lt;/span&gt;&lt;span class="s2"&gt;$_"&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_33a25e4132b94e18b2d1c26ca2d0f46d-7"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Source: &lt;a class="reference external" href="http://stackoverflow.com/questions/4208694/"&gt;http://stackoverflow.com/questions/4208694/&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="changelog"&gt;
&lt;h2&gt;Changelog&lt;/h2&gt;
&lt;dl class="simple"&gt;
&lt;dt&gt;[2020-03-01 Sun]&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Add a note that current prompt customization is for &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;posh-git&lt;/span&gt;&lt;/code&gt; version 0.7.x.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;[2017-04-22 Sat]&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Update prompt customization script for the latest version of &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;posh-git&lt;/span&gt;&lt;/code&gt;
(0.7.2)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Update &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;Git-ChildItemColor&lt;/span&gt;&lt;/code&gt; related information&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;[2017-01-03 Tue]&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Update prompt customization script for the latest version of &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;posh-git&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>git</category><category>posh</category><category>PowerShell</category><category>settings</category><category>windows</category><guid>http://joonro.github.io/blog/posts/powershell-customizations/</guid><pubDate>Sun, 01 Mar 2020 22:00:00 GMT</pubDate></item><item><title>Windows 10: How to Enable Dark mode in PowerShell</title><link>http://joonro.github.io/blog/posts/windows-10-enable-dark-mode-posh/</link><dc:creator>Joon Ro</dc:creator><description>&lt;div&gt;&lt;p&gt;With &lt;a class="reference external" href="https://blogs.windows.com/windowsexperience/2016/08/02/new-video-series-this-week-on-windows-highlights-windows-10-anniversary-update/"&gt;Windows 10 Anniversary Update&lt;/a&gt;, one can choose between the &lt;a class="reference external" href="https://blogs.windows.com/windowsexperience/2016/08/08/windows-10-tip-personalize-your-pc-by-enabling-the-dark-theme/"&gt;light and dark
modes&lt;/a&gt;. Here is a set of PowerShell commands to set this in case you want to automate
it. These are slightly modified commands from this &lt;a class="reference external" href="https://www.reddit.com/r/windows/comments/3f0n2u/windows_10_enable_dark_mode/"&gt;reddit&lt;/a&gt; post.&lt;/p&gt;
&lt;p&gt;To use the dark mode:&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="http://joonro.github.io/blog/posts/windows-10-enable-dark-mode-posh/#rest_code_10c42f90201a4d78a97076f0175e5460-0"&gt;0&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code PowerShell"&gt;&lt;a name="rest_code_10c42f90201a4d78a97076f0175e5460-0"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-ItemProperty&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="n"&gt;HKCU&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;SOFTWARE&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Microsoft&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Windows&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;CurrentVersion&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Themes&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Personalize&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;AppsUseLightTheme&lt;/span&gt; &lt;span class="n"&gt;-Value&lt;/span&gt; &lt;span class="n"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;To use the light mode:&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="http://joonro.github.io/blog/posts/windows-10-enable-dark-mode-posh/#rest_code_c5f53b485ba3466d871d772248ae2f66-0"&gt;0&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code PowerShell"&gt;&lt;a name="rest_code_c5f53b485ba3466d871d772248ae2f66-0"&gt;&lt;/a&gt;&lt;span class="nb"&gt;Set-ItemProperty&lt;/span&gt; &lt;span class="n"&gt;-Path&lt;/span&gt; &lt;span class="n"&gt;HKCU&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;SOFTWARE&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Microsoft&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Windows&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;CurrentVersion&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Themes&lt;/span&gt;&lt;span class="p"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Personalize&lt;/span&gt; &lt;span class="n"&gt;-Name&lt;/span&gt; &lt;span class="n"&gt;AppsUseLightTheme&lt;/span&gt; &lt;span class="n"&gt;-Value&lt;/span&gt; &lt;span class="n"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</description><category>dark</category><category>posh</category><category>PowerShell</category><category>settings</category><category>theme</category><category>windows</category><guid>http://joonro.github.io/blog/posts/windows-10-enable-dark-mode-posh/</guid><pubDate>Wed, 10 Feb 2016 22:00:00 GMT</pubDate></item><item><title>org-mode Google calendar sync in Windows</title><link>http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/</link><dc:creator>Joon Ro</dc:creator><description>&lt;div&gt;&lt;div id="table-of-contents"&gt;
&lt;h3&gt;Table of Contents&lt;/h3&gt;
&lt;div id="text-table-of-contents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/#orgheadline3"&gt;1. Dependencies&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/#orgheadline1"&gt;1.1. &lt;code&gt;ical2org.py&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/#orgheadline2"&gt;1.2. Find your private URL for your calendar&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/#orgheadline4"&gt;2. PowerShell script&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/#orgheadline5"&gt;3. Install cron&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;
The &lt;a href="http://orgmode.org/worg/org-tutorials/org-google-sync.html"&gt;instructions&lt;/a&gt; at Org-mode does not cover the Windows case. I explain how
you can get the sync between Google calendar and org-mode in Windows.
&lt;/p&gt;

&lt;div id="outline-container-orgheadline3" class="outline-2"&gt;
&lt;h3 id="orgheadline3"&gt;&lt;span class="section-number-2"&gt;1&lt;/span&gt; Dependencies&lt;/h3&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;/div&gt;&lt;div id="outline-container-orgheadline1" class="outline-3"&gt;
&lt;h4 id="orgheadline1"&gt;&lt;span class="section-number-3"&gt;1.1&lt;/span&gt; &lt;code&gt;ical2org.py&lt;/code&gt;&lt;/h4&gt;
&lt;div class="outline-text-3" id="text-1-1"&gt;
&lt;p&gt;
Get the &lt;code&gt;ical2org.py&lt;/code&gt; script from &lt;a href="https://github.com/asoroa/ical2org.py"&gt;https://github.com/asoroa/ical2org.py&lt;/a&gt;. You
have to have Python installed, and also need to install &lt;code&gt;icalendar&lt;/code&gt; and &lt;code&gt;pytz&lt;/code&gt;:
&lt;/p&gt;

&lt;div class="org-src-container"&gt;


&lt;pre&gt;&lt;code class="lang-sh"&gt;&amp;gt; pip install icalendar
&amp;gt; pip install pytz
&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgheadline2" class="outline-3"&gt;
&lt;h4 id="orgheadline2"&gt;&lt;span class="section-number-3"&gt;1.2&lt;/span&gt; Find your private URL for your calendar&lt;/h4&gt;
&lt;div class="outline-text-3" id="text-1-2"&gt;
&lt;p&gt;
Follow step 2 in this &lt;a href="http://orgmode.org/worg/org-tutorials/org-google-sync.html"&gt;instruction&lt;/a&gt; to get the private URL for your calendar.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgheadline4" class="outline-2"&gt;
&lt;h3 id="orgheadline4"&gt;&lt;span class="section-number-2"&gt;2&lt;/span&gt; PowerShell script&lt;/h3&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;p&gt;
First check if you can download your calendar with &lt;code&gt;Invoke-WebRequest&lt;/code&gt;:
&lt;/p&gt;

&lt;div class="org-src-container"&gt;


&lt;pre&gt;&lt;code class="lang-posh"&gt;&amp;gt; Invoke-WebRequest -URI &amp;lt;url to your private Google calendar&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;

&lt;p&gt;
If it works, make a PowerShell script file,  &lt;code&gt;convert-gcal-to-org.ps1&lt;/code&gt;:
&lt;/p&gt;

&lt;div class="org-src-container"&gt;


&lt;pre&gt;&lt;code class="lang-posh"&gt;# customize these
$ICS2ORG = "&amp;lt;path to ical2org.py&amp;gt;"
$ICSFILE = "&amp;lt;path for icsfile&amp;gt;"
$ORGFILE = "&amp;lt;path to orgfile&amp;gt;"
$URL = "&amp;lt;url to your private Google calendar&amp;gt;"

# no customization needed below
$Content = (Invoke-WebRequest -URI $URL).Content
[System.IO.File]::WriteAllLines($ICSFILE, $Content)

python $ICS2ORG $ICSFILE $ORGFILE
&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;

&lt;p&gt;
for example:
&lt;/p&gt;

&lt;div class="org-src-container"&gt;


&lt;pre&gt;&lt;code class="lang-posh"&gt;# customize these    
$ICS2ORG = "~/bin/ical2org.py"
$ICSFILE = "~/bin/gcal-shared.ical"
$ORGFILE = "~/gcal.org"
$URL = "https://www.google.com/calendar/ical/...../basic.ics"

# no customization needed below
$Content = (Invoke-WebRequest -URI $URL).Content
[System.IO.File]::WriteAllLines($ICSFILE, $Content) 

python $ICS2ORG $ICSFILE $ORGFILE
&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;

&lt;p&gt;
Now try the script and see if it works:
&lt;/p&gt;

&lt;div class="org-src-container"&gt;


&lt;pre&gt;&lt;code class="lang-posh"&gt;&amp;gt; convert-gcal-to-org.ps1
&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;

&lt;p&gt;
If you have the output &lt;code&gt;org&lt;/code&gt; file in your &lt;code&gt;org-agenda-files&lt;/code&gt; list, you will
see the entries from Google calendar when you update your agenda in Emacs.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-orgheadline5" class="outline-2"&gt;
&lt;h3 id="orgheadline5"&gt;&lt;span class="section-number-2"&gt;3&lt;/span&gt; Install cron&lt;/h3&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;p&gt;
You can install &lt;a href="http://www.intelliadmin.com/index.php/2012/05/free-utility-a-simple-task-scheduler-for-windows/"&gt;IntelliAdmin Cron&lt;/a&gt; to periodically run the script and sync your
calendars with &lt;code&gt;org-mode&lt;/code&gt;. &lt;a href="http://thecrumb.com/2013/03/24/new-cron-for-windows/"&gt;Here&lt;/a&gt; is a blog post about this specific cron utility.
&lt;/p&gt;

&lt;p&gt;
Then, use the following to set up the cronjob, with appropriate schedule settings:
&lt;/p&gt;

&lt;dl class="org-dl"&gt;
&lt;dt&gt;EXE File&lt;/dt&gt;&lt;dd&gt;&lt;code&gt;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&lt;/code&gt;&lt;/dd&gt;
&lt;dt&gt;Arguments&lt;/dt&gt;&lt;dd&gt;&lt;code&gt;-file C:\PATH\TO\convert-gcal-to-org.ps1&lt;/code&gt;&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;
For example:
&lt;/p&gt;


&lt;div class="figure"&gt;
&lt;p&gt;&lt;img src="http://joonro.github.io/blog/wp-content/Capture-crontab-org-mode-google-sync.png" alt="Capture-crontab-org-mode-google-sync.png"&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>emacs</category><category>org</category><category>posh</category><category>windows</category><guid>http://joonro.github.io/blog/posts/org-mode-google-calendar-sync-in-windows/</guid><pubDate>Sat, 09 May 2015 20:27:18 GMT</pubDate></item></channel></rss>